# =====================================================
# Configuration des Microservices - Fichier .env.example
# =====================================================
# COPIER CE FICHIER EN .env POUR COMMENCER LE D√âVELOPPEMENT LOCAL
# cp .env.example .env
# NE PAS commiter ce fichier avec des valeurs r√©elles en production

# =====================================================
# üìä Configuration PostgreSQL
# =====================================================
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=changeme
POSTGRES_DB_AUTH=auth_db
POSTGRES_DB_USER=user_db
POSTGRES_DB_ORDER=order_db

# =====================================================
# üîê Configuration JWT (Auth Service)
# =====================================================
# ‚ö†Ô∏è IMPORTANT: G√©n√©rer une cl√© secr√®te robuste pour la production
# Vous pouvez g√©n√©rer une cl√© avec: openssl rand -base64 32
JWT_SECRET=changeme_generate_a_secure_key_with_openssl_rand_base64_32
JWT_EXPIRATION=86400000
JWT_REFRESH_EXPIRATION=604800000

# =====================================================
# üåê Configuration Eureka (Discovery Service)
# =====================================================
EUREKA_INSTANCE_HOSTNAME=localhost
DISCOVERY_SERVICE_PORT=8761
EUREKA_CLIENT_SERVICEURL_DEFAULTZONE=http://${EUREKA_INSTANCE_HOSTNAME}:${DISCOVERY_SERVICE_PORT}/eureka/
EUREKA_INSTANCE_PREFER_IP_ADDRESS=false

# =====================================================
# üö™ Ports des Services
# =====================================================
DISCOVERY_SERVICE_PORT=8761
API_GATEWAY_PORT=8080
AUTH_SERVICE_PORT=8081
USER_SERVICE_PORT=8082
ORDER_SERVICE_PORT=8083

# =====================================================
# üìç URLs des Services (pour Feign Client)
# =====================================================
AUTH_SERVICE_URL=http://localhost:8081
USER_SERVICE_URL=http://localhost:8082
ORDER_SERVICE_URL=http://localhost:8083

# =====================================================
# üîÑ Configuration Feign Client
# =====================================================
FEIGN_CONNECT_TIMEOUT=10000
FEIGN_READ_TIMEOUT=10000
FEIGN_WRITE_TIMEOUT=10000

# =====================================================
# üõ°Ô∏è Configuration Circuit Breaker (Resilience4j)
# =====================================================
RESILIENCE4J_FAILURE_RATE_THRESHOLD=50
RESILIENCE4J_WAIT_DURATION_IN_OPEN_STATE=60000
RESILIENCE4J_SLOW_CALL_RATE_THRESHOLD=100
RESILIENCE4J_SLOW_CALL_DURATION_THRESHOLD=5000
RESILIENCE4J_MINIMUM_NUMBER_OF_CALLS=10

# =====================================================
# üìã Configuration Logging
# =====================================================
LOGGING_LEVEL_ROOT=INFO
LOGGING_LEVEL_COM_MICROSERVICES=DEBUG
LOGGING_LEVEL_ORG_SPRINGFRAMEWORK=INFO
LOGGING_LEVEL_ORG_SPRINGFRAMEWORK_SECURITY=DEBUG

# =====================================================
# üåç Configuration CORS
# =====================================================
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:4200,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=*
CORS_ALLOW_CREDENTIALS=true

# =====================================================
# üìä Configuration Actuator (Monitoring)
# =====================================================
ACTUATOR_ENDPOINTS_WEB_EXPOSURE_INCLUDE=health,info,metrics,circuitbreakers,retry,env
ACTUATOR_ENDPOINT_HEALTH_SHOW_DETAILS=when-authorized

# =====================================================
# üóÑÔ∏è Configuration JPA/Hibernate
# =====================================================
JPA_HIBERNATE_DDL_AUTO=update
JPA_SHOW_SQL=false
JPA_PROPERTIES_HIBERNATE_FORMAT_SQL=true
JPA_PROPERTIES_HIBERNATE_JDBC_BATCH_SIZE=20
JPA_PROPERTIES_HIBERNATE_ORDER_INSERTS=true
JPA_PROPERTIES_HIBERNATE_ORDER_UPDATES=true

# =====================================================
# üì± Configuration Swagger/OpenAPI
# =====================================================
SWAGGER_TITLE=API Microservices
SWAGGER_DESCRIPTION=Documentation API compl√®te des microservices
SWAGGER_VERSION=1.0.0
SWAGGER_CONTACT_NAME=Microservices Team
SWAGGER_CONTACT_EMAIL=contact@microservices.com
SWAGGER_CONTACT_URL=https://microservices.com
SWAGGER_LICENSE_NAME=Apache License 2.0
SWAGGER_LICENSE_URL=https://www.apache.org/licenses/LICENSE-2.0.html

# =====================================================
# ‚òÅÔ∏è Configuration Profil Spring
# =====================================================
SPRING_PROFILES_ACTIVE=dev
# Options: dev, test, prod

# =====================================================
# üåç Configuration Serveur
# =====================================================
SERVER_SERVLET_CONTEXT_PATH=/
SERVER_ERROR_INCLUDE_MESSAGE=always
SERVER_ERROR_INCLUDE_STACKTRACE=on-param
SERVER_ERROR_INCLUDE_EXCEPTION=false

# =====================================================
# ‚è±Ô∏è Configuration Timeouts
# =====================================================
SERVER_SERVLET_SESSION_TIMEOUT=30m
SPRING_DATASOURCE_HIKARI_MAXIMUM_POOL_SIZE=20
SPRING_DATASOURCE_HIKARI_MINIMUM_IDLE=5
SPRING_DATASOURCE_HIKARI_CONNECTION_TIMEOUT=20000
SPRING_DATASOURCE_HIKARI_IDLE_TIMEOUT=300000
SPRING_DATASOURCE_HIKARI_MAX_LIFETIME=1200000

# =====================================================
# üîÑ Configuration Redis (Optionnel - pour cache)
# =====================================================
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=
# REDIS_TIMEOUT=2000

# =====================================================
# üì® Configuration Email (Optionnel)
# =====================================================
# MAIL_HOST=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USERNAME=votre-email@gmail.com
# MAIL_PASSWORD=votre-mot-de-passe
# MAIL_FROM=noreply@microservices.com

# =====================================================
# üì≤ Configuration SMS (Optionnel - Twilio)
# =====================================================
# TWILIO_ACCOUNT_SID=
# TWILIO_AUTH_TOKEN=
# TWILIO_PHONE_NUMBER=

# =====================================================
# üîë Configuration Cl√©s API (Optionnel)
# =====================================================
# STRIPE_SECRET_KEY=
# STRIPE_PUBLIC_KEY=
# PAYPAL_CLIENT_ID=
# PAYPAL_CLIENT_SECRET=

# =====================================================
# üìä Configuration M√©triques Prometheus
# =====================================================
METRICS_EXPORT_PROMETHEUS_ENABLED=true
MANAGEMENT_ENDPOINTS_WEB_EXPOSURE_INCLUDE=prometheus

# =====================================================
# üîç Configuration Tracing (Optionnel)
# =====================================================
# TRACING_ENABLED=false
# TRACING_ZIPKIN_ENDPOINT=http://localhost:9411/api/v2/spans

# =====================================================
# üìù Guide de mise en place
# =====================================================
# 1. Copier ce fichier en .env:
#    $ cp .env.example .env
#
# 2. Mettre √† jour les valeurs selon votre environnement local:
#    $ nano .env
#
# 3. G√©n√©rer une cl√© JWT s√©curis√©e (recommand√©):
#    $ openssl rand -base64 32
#    Puis remplacer la valeur JWT_SECRET par le r√©sultat
#
# 4. S'assurer que PostgreSQL est en cours d'ex√©cution:
#    $ sudo systemctl start postgresql
#
# 5. Cr√©er les bases de donn√©es si n√©cessaire:
#    $ psql -U postgres -c "CREATE DATABASE auth_db;"
#    $ psql -U postgres -c "CREATE DATABASE user_db;"
#    $ psql -U postgres -c "CREATE DATABASE order_db;"
#
# 6. Lancer les microservices:
#    # Terminal 1: Discovery Service
#    $ cd discovery-service && mvn spring-boot:run
#
#    # Terminal 2: Auth Service
#    $ cd auth-service && mvn spring-boot:run
#
#    # Terminal 3: User Service
#    $ cd user-service && mvn spring-boot:run
#
#    # Terminal 4: Order Service
#    $ cd order-service && mvn spring-boot:run
#
#    # Terminal 5: API Gateway
#    $ cd api-gateway && mvn spring-boot:run
#
# 7. Acc√©der aux services:
#    - API Gateway: http://localhost:8080
#    - Eureka Dashboard: http://localhost:8761
#    - Auth Service: http://localhost:8081
#    - User Service: http://localhost:8082
#    - Order Service: http://localhost:8083
#    - Swagger/API Docs: http://localhost:8080/swagger-ui.html
#
# =====================================================
# üîê Notes de s√©curit√©
# =====================================================
# ‚ö†Ô∏è JAMAIS commiter ce fichier avec des valeurs r√©elles
# ‚ö†Ô∏è JAMAIS partager vos secrets (JWT_SECRET, mots de passe)
# ‚ö†Ô∏è Ajouter .env* dans .gitignore
# ‚ö†Ô∏è Utiliser un gestionnaire de secrets en production
# ‚ö†Ô∏è Changer JWT_SECRET avant le d√©ploiement en production